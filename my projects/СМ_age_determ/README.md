<h1> Определение возраста покупателей <a class="tocSkip"></h1> 

<h2> Задачи проекта <a class="tocSkip"></h2>
    
    
Необходимо разработать и внедрить систему компьютерного зрения для обработки фотографий покупателей  супермаркета с целью определения возраста. Требуется построить модель, которая по фотографии определит приблизительный возраст человека. 
    
Цели заказчика: 
    
1. Анализировать покупки и предлагать товары, которые могут заинтересовать покупателей определенной возрастной группы;
2. Контролировать добросовестность кассиров при продаже алкоголя.
    
Соответственно, для решения поставленной задачи (задачи регрессии) имеет смысл использовать такие метрики качества, как MSE и MAE. Также нам необходимо добиться хорошего показателя этих метрик, так как сильные отклонения могут оказаться критичными.</div> 


<h2> План работы <a class="tocSkip"></h2>
    
  - Загрузка исходного датасета 
  - Построение гистограммы распределенния возрастов покупателей
  - Оценка, какова общая ориентация фотографий (нужно ли их поворачивать), есть ли черно-белые фотографии, 
    различается ли размер изображений
  - Разделение данных на фичи и таргет
  - Использовать сверточную нейронную сеть. 
  - Использовать необходимые дополнительные слои согласно поставленной задаче
  - Сделать выводы


<h2> ОТЧЕТ <a class="tocSkip"></h2>

  - Была использована динамическая загрузка данных, а именно загрузчик данных ImageDataGenerator.
  - На гистограмме распределения возрастов можно заметить два кластера: маленький с экстремумом в x=5 и второй большой с точкой 
    максимума при x=29. Такжеприсутствуют отдельные пиковые значения возраста, и наблюдается "бимодальность". Распределение смещено вправо.
    Выбросы могут быть связаны с тем, что настоящий возраст был неизвестен заранее и округлялся до "юбилейных" лет. Поэтому, некоторые 
    "круглые" года в датасете некорректные. Наибольшее значение возраста - 100 лет (и это не выброс, а реальная старушка). 
  - Общая ориентация фотографий - вертикальная, переворачивать не требуется, фото преимущественно цветные, размер уже приведен к 
    единому - 224 на 224 пикселя. В основном лица на фото крупным планом, хотя встречаются фото в полный рост.
  - В качестве признаков получили четырёхмерный тензор, в котором 32 изображения размером 224x224 с тремя цветовыми каналами.
  - Для обучения модели использовалась архитектура ResNet50 с весами из ImageNet.
  - В качестве метрики качества использовалась MAE, так как она менее чувствительна к выбросам, нежели MSE (Результат MAE = 6.49). 
  - Во избежание переобучения, была «заморожена» часть сети: некоторые слои были оставлены с весами из ImageNet, они не обучались градиентным спуском. 
  - Помимо архитектуры ResNet в Keras использовался GlobalAveragePooling2D — пулинг с окном во весь тензор, и один полносвязный 
    слой Dense с одним нейроном (так как решалась задача регрессии) на выходе для получения модели.
  - Функция активации использовалась ReLU. Так не могут быть отрицательные значения возраста.
  - Для автоматического подбора шага градиентного спуска применялся алгоритм Adam.
